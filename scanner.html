<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <title>Brand Vulnerability Scanner</title>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500&family=JetBrains+Mono&display=swap" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <link rel="icon" type="image/png" href="Chromaspark.png.jpeg" />
  <style>
    /* Reset */
    *, *::before, *::after {
      box-sizing: border-box;
    }
    body {
      margin: 0;
      padding: 0;
      font-family: 'JetBrains Mono', monospace;
      background-color: #05013d;
      color: #fdb43b;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }
    header {
      text-align: center;
      padding: 2rem 1rem;
      background: linear-gradient(to right, #05013d, #fdb43b);
    }
    header h1 {
      font-family: 'Orbitron', sans-serif;
      font-size: 2rem;
      color: #05013d;
      letter-spacing: 2px;
      margin-bottom: 0.5rem;
    }
    header p {
      color: #fff;
      font-size: 1rem;
      max-width: 800px;
      margin: 0 auto;
      line-height: 1.4;
    }
    main {
      max-width: 600px;
      margin: 1.5rem auto 3rem;
      padding: 2rem;
      background-color: #1a1a1a;
      border-radius: 8px;
      box-shadow: 0 0 15px #00ffcc33;
    }
    label {
      display: block;
      margin-top: 1.25rem;
      font-weight: 600;
      font-size: 1rem;
    }
    input, select, textarea {
      width: 100%;
      margin-top: 0.5rem;
      padding: 0.75rem 1rem;
      background-color: #111;
      color: #fdb43b;
      border: 1px solid #fdb43b;
      border-radius: 4px;
      font-size: 1rem;
      font-family: inherit;
      transition: border-color 0.3s ease;
    }
    input:focus, select:focus, textarea:focus {
      outline: none;
      border-color: #00ffcc;
      background-color: #222;
    }
    button {
      margin-top: 1.5rem;
      padding: 0.75rem 1.5rem;
      background-color: #fdb43b;
      color: #000;
      font-weight: bold;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 1.1rem;
      width: 100%;
      transition: background-color 0.3s ease;
    }
    button:hover {
      background-color: #e0a620;
    }
    .results {
      display: none;
      margin-top: 2rem;
      background: #111;
      padding: 1rem;
      border: 1px solid #fdb43b;
      border-radius: 6px;
    }
    .results h2 {
      color: #fdb43b;
      margin-bottom: 0.5rem;
    }
    .score {
      font-size: 1.2rem;
      color: #ff3c38;
      font-weight: 700;
    }
    canvas {
      margin-top: 2rem;
      max-width: 100% !important;
      height: auto !important;
    }
    #downloadBtn {
      margin-top: 1rem;
      background-color: #fdb43b;
      color: #000;
    }

    /* Navbar */
    nav.navbar {
      background-color: #05013d;
      color: white;
      padding: 10px 20px;
      position: sticky;
      top: 0;
      z-index: 9999;
      box-shadow: 0 2px 6px rgba(0,0,0,0.6);
    }
    .navbar-container {
      display: flex;
      justify-content: space-between;
      align-items: center;
      max-width: 1200px;
      margin: 0 auto;
      flex-wrap: wrap;
    }
    .navbar-logo {
      font-family: 'Arial', sans-serif;
      font-size: 1.8rem;
      font-weight: bold;
      text-decoration: none;
      color: white;
      display: flex;
      align-items: center;
    }
    .navbar-logo-img {
      width: 60px;
      height: 60px;
      margin-right: 10px;
      border-radius: 300px;
      object-fit: contain;
    }
    .navbar-links {
      list-style: none;
      display: flex;
      gap: 20px;
      margin: 0;
      padding: 0;
    }
    .navbar-links li {
      display: inline;
    }
    .navbar-links a {
      text-decoration: none;
      color: white;
      font-size: 1.1rem;
      padding: 8px 15px;
      border-radius: 5px;
      transition: background-color 0.3s ease;
      white-space: nowrap;
    }
    .navbar-links a:hover {
      background-color: #fdb43b;
      color: #05013d;
    }

    /* Mobile menu toggle */
    .menu-toggle {
      display: none;
      flex-direction: column;
      cursor: pointer;
    }
    .menu-toggle .bar {
      width: 25px;
      height: 3px;
      background-color: white;
      margin: 4px 0;
      transition: 0.4s;
      border-radius: 2px;
    }

    /* Responsive */
    @media (max-width: 700px) {
      main {
        margin: 1rem;
        padding: 1.5rem;
      }
      header h1 {
        font-size: 1.6rem;
      }
      label {
        font-size: 0.95rem;
      }
      input, select, textarea, button {
        font-size: 1rem;
      }

      .navbar-links {
        flex-direction: column;
        width: 100%;
        display: none; /* hidden by default on mobile */
        background-color: #05013d;
        margin-top: 10px;
      }
      .navbar-links.active {
        display: flex;
      }
      .navbar-links li {
        width: 100%;
      }
      .navbar-links a {
        padding: 12px 20px;
        display: block;
      }

      .menu-toggle {
        display: flex;
      }
      .navbar-logo-img {
        width: 50px;
        height: 50px;
      }
      .navbar-logo {
        font-size: 1.4rem;
      }
    }
  </style>
</head>
<body>
  <nav class="navbar">
    <div class="navbar-container">
      <a href="#home" class="navbar-logo">
        <img src="Chromaspark.png.jpeg" alt="Chroma Spark Logo" class="navbar-logo-img" />
        Chroma Spark
      </a>
      <ul class="navbar-links" id="navbar-links">
        <li><a href="SeniorProject.html">Back To Home</a></li>
      </ul>
      <div class="menu-toggle" id="mobile-menu" aria-label="Toggle menu" tabindex="0" role="button">
        <span class="bar"></span>
        <span class="bar"></span>
        <span class="bar"></span>
      </div>
    </div>
  </nav>

  <header>
    <h1>üîê Brand Vulnerability Scanner</h1>
    <p>
      This tool helps you scan for design and security vulnerabilities in your logo and brand identity. A strong, secure, and attractive brand begins with a well-crafted logo ‚Äî let's make sure yours stands out for the right reasons.
    </p>
  </header>

  <main>
    <form id="scanForm">
      <!-- Questions (truncated here for brevity) -->
      <!-- Repeat your labels and selects here as before, e.g.: -->
      <label>Is your logo readable on mobile?</label>
      <select name="mobile" required>
        <option value="yes">Yes</option>
        <option value="no">No</option>
      </select>
      <!-- Add all other questions here... -->

      <!-- (Include all your questions exactly as in your original form) -->

      <button type="submit">Run Scan</button>
    </form>

    <div class="results" id="results">
      <h2>üõ°Ô∏è Vulnerability Report</h2>
      <p class="score">Visual Trust Score: <span id="trustScore">--</span>%</p>
      <div id="aiTips"></div>
      <p>‚è±Ô∏è Scan Timestamp: <span id="timestamp"></span></p>
      <canvas id="radarChart"></canvas>
      <button id="downloadBtn">üìÑ Download PDF Report</button>
    </div>

    <form id="logoForm" enctype="multipart/form-data" style="margin-top: 2rem;">
      <label>Upload Logo:</label>
      <input type="file" name="logo" accept="image/*" required />
      <button type="submit">Analyze</button>
    </form>
    <div id="logoResult" style="margin-top: 1rem;"></div>
  </main>

  <script>
    // Mobile menu toggle
    const menuToggle = document.getElementById('mobile-menu');
    const navbarLinks = document.getElementById('navbar-links');

    menuToggle.addEventListener('click', () => {
      navbarLinks.classList.toggle('active');
      menuToggle.classList.toggle('active');
    });

    // Accessibility: allow toggle on Enter key for keyboard users
    menuToggle.addEventListener('keydown', e => {
      if (e.key === 'Enter' || e.key === ' ') {
        e.preventDefault();
        menuToggle.click();
      }
    });

    // Your existing form & results JS (unchanged) ...
    const form = document.getElementById('scanForm');
    const results = document.getElementById('results');
    const downloadBtn = document.getElementById('downloadBtn');

    const chartLabels = [
      'Mobile Logo', 'CTA Visibility', 'Font Readability', 'Consistency', 'HTTPS',
      'Accessibility', 'Speed', 'Grid Layout', 'Color Palette', 'Animation', 'Icons',
      'Trademark Registered', 'Brand Monitoring', 'Asset Security', 'Access Control',
      'Brand Response Plan', 'Logo Uniqueness', 'Logo Scalability', 'Logo Memorability',
      'Brand Alignment', 'Logo Guidelines'
    ];

    let values = [];

    form.addEventListener('submit', function (e) {
      e.preventDefault();
      values = [];

      const fields = [
        'mobile', 'contrast', 'font', 'consistency', 'security', 'accessibility',
        'loading', 'grid', 'color', 'animation', 'icons',
        'trademark_registered', 'brand_monitoring', 'asset_security', 'access_control',
        'brand_response_plan', 'logo_uniqueness', 'logo_scalability',
        'logo_memorability', 'brand_alignment', 'logo_guidelines', 'logo_scalability', 'logo_bw', 'logo_meaning', 'audience_alignment', 'uniqueness', 'font_consistency', 'style_guide', 'brand_update'
      ];

      let score = 100;
      let feedback = [];

      const labelMap = {
        mobile: 'Logo Readability on Mobile',
        contrast: 'CTA Visibility',
        font: 'Font Readability',
        consistency: 'Design Consistency',
        security: 'HTTPS Usage',
        accessibility: 'Accessibility',
        loading: 'Loading Speed',
        grid: 'Grid Layout',
        color: 'Color Palette',
        animation: 'Animations',
        icons: 'Icons',
        trademark_registered: 'Trademark Registration',
        brand_monitoring: 'Brand Monitoring',
        asset_security: 'Asset Security',
        access_control: 'Access Control',
        brand_response_plan: 'Brand Response Plan',
        logo_uniqueness: 'Logo Uniqueness',
        logo_scalability: 'Logo Scalability',
        logo_memorability: 'Logo Memorability',
        brand_alignment: 'Brand Alignment',
        logo_guidelines: 'Logo Usage Guidelines',
        logo_bw: 'Logo Black/White Compatibility',
        logo_meaning: 'Logo Meaning',
        audience_alignment: 'Target Audience Alignment',
        uniqueness: 'Visual Uniqueness',
        font_consistency: 'Font Consistency',
        style_guide: 'Style Guide Presence',
        brand_update: 'Brand Design Updates'
      };

      fields.forEach((field) => {
        const value = form[field]?.value;
        if (value === 'no') {
          score -= 5;
          feedback.push(`‚ö†Ô∏è ${labelMap[field]} needs attention.`);
          values.push(50);
        } else {
          values.push(100);
        }
      });

      document.getElementById('trustScore').textContent = score;
      const aiSuggestions = generateAIRecommendations(score, feedback);
      document.getElementById('aiTips').innerHTML = `<p>${aiSuggestions}</p>`;
      document.getElementById('timestamp').textContent = new Date().toLocaleString();
      results.style.display = 'block';

      const ctx = document.getElementById('radarChart').getContext('2d');
      if (window.radarChart) window.radarChart.destroy();
      window.radarChart = new Chart(ctx, {
        type: 'radar',
        data: {
          labels: chartLabels,
          datasets: [{
            label: 'Design Health',
            data: values,
            backgroundColor: 'rgba(0, 255, 136, 0.2)',
            borderColor: '#00ff88',
            borderWidth: 2,
            pointBackgroundColor: '#00ff88'
          }]
        },
        options: {
          scales: {
            r: {
              angleLines: { color: '#444' },
              grid: { color: '#333' },
              pointLabels: { color: '#ccc' },
              ticks: {
                color: '#00ffcc',
                stepSize: 25,
                backdropColor: 'transparent'
              }
            }
          },
          plugins: {
            legend: { labels: { color: '#00ff88' } }
          }
        }
      });
    });

    function generateAIRecommendations(score, feedbackList) {
      if (score === 100) return '‚úÖ Excellent! Your brand is visually strong and secure.';
      if (score > 80) return 'üîç Great job! But consider optimizing:<br>' + feedbackList.join('<br>');
      if (score > 60) return '‚ö†Ô∏è Moderate risks detected. Focus on improving:<br>' + feedbackList.join('<br>');
      return 'üö® Critical vulnerabilities in visual identity. Immediate attention required:<br>' + feedbackList.join('<br>');
    }

    downloadBtn.addEventListener('click', async () => {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();

      doc.setFont('helvetica');
      doc.setFontSize(14);
      doc.text('Brand Vulnerability Scan Report', 10, 10);
      doc.setFontSize(11);
      doc.text(`Score: ${document.getElementById('trustScore').textContent}%`, 10, 20);
      doc.text(`Time: ${document.getElementById('timestamp').textContent}`, 10, 30);

      const feedbackText = document.getElementById('aiTips').innerText.split('\n');
      let y = 40;
      feedbackText.forEach(f => {
        doc.text(f, 10, y);
        y += 10;
      });

      doc.save('brand_scan_report.pdf');
    });

    // Logo form submission with AJAX
    const logoForm = document.getElementById('logoForm');
    const logoResult = document.getElementById('logoResult');

    logoForm.addEventListener('submit', function(e) {
      e.preventDefault();

      const formData = new FormData(logoForm);

      fetch('segment_logo.php', {
        method: 'POST',
        body: formData
      })
      .then(res => res.text())
      .then(data => {
        logoResult.innerHTML = data; // Expecting HTML output (like <img src="..." />)
      })
      .catch(error => {
        console.error('Error:', error);
        logoResult.innerHTML = "<p style='color:red;'>Error processing logo.</p>";
      });
    });
  </script>
</body>
</html>
